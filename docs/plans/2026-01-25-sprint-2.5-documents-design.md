# Sprint 2.5 - Documents Section Design

## Goal

Build the public documents page at `/dokumenti` with category sidebar navigation, year filtering, search, and downloadable PDF list.

## Architecture

Server-rendered page using `documentsRepository.findAll()` with URL-driven filtering. Desktop uses sticky sidebar for categories; mobile uses accordion. Client-side search filters the current page instantly without server round-trip.

## Page Structure

**URL:** `/dokumenti` with optional `?kategorija=proracun&godina=2026&stranica=1`

**Desktop Layout (lg+):**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Povratak na poÄetnu                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Dokumenti                                                  â”‚
â”‚  SluÅ¾beni dokumenti OpÄ‡ine Veliki Bukovec                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                â”‚  [Search input]         [Year dropdown â–¼]  â”‚
â”‚  KATEGORIJE    â”‚                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  Showing 24 documents                      â”‚
â”‚  â€¢ Sjednice    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â€¢ ProraÄun    â”‚  â”‚ ğŸ“„ ProraÄun za 2026.     [Preuzmi] â”‚   â”‚
â”‚  â€¢ Planovi     â”‚  â”‚    12. sijeÄnja 2026.              â”‚   â”‚
â”‚  ...           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                â”‚  [Pagination]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Mobile Layout:** Categories collapse into accordion at top, document list below.

## Components

### New UI Components

| Component | Props | Description |
|-----------|-------|-------------|
| DocumentCard | title, fileUrl, fileSize, createdAt | Single document row with PDF icon, title, date, download button |
| DocumentSidebar | categories, activeCategory, counts | Desktop sticky sidebar with category links and counts |
| DocumentAccordion | categories, activeCategory, counts | Mobile accordion for category navigation |
| YearFilter | years, selectedYear, onChange | Year dropdown using Select primitive |

### Reused Components
- FadeIn, Input, Pagination, Badge

## Data Flow

1. Page receives searchParams (kategorija, godina, stranica)
2. Server fetches documents via `documentsRepository.findAll({ category, year, page, limit: 20 })`
3. Server fetches category counts via `documentsRepository.getCategoryCounts()`
4. Server fetches available years via `documentsRepository.getDistinctYears()`
5. Client-side search filters displayed documents instantly

## Repository Additions

```typescript
// Get distinct years for year filter dropdown
async getDistinctYears(): Promise<number[]>

// Get document counts per category for sidebar badges
async getCategoryCounts(): Promise<Record<string, number>>
```

## URL State

| Param | Example | Default |
|-------|---------|---------|
| kategorija | proracun | (all categories) |
| godina | 2026 | (all years) |
| stranica | 2 | 1 |

Client-side search does NOT persist to URL (ephemeral).

## Error Handling

| Scenario | Behavior |
|----------|----------|
| No documents | "Trenutno nema dostupnih dokumenata." |
| No docs in category | "Nema dokumenata u kategoriji [Name]." |
| No docs for year | "Nema dokumenata za godinu [Year]." |
| Search no results | "Nema rezultata za '[query]'." |
| Invalid category/year | Ignore, show unfiltered |
| Page > totalPages | Clamp to last page |

## SEO

- Static metadata for base page
- Dynamic title when category selected: "ProraÄun - Dokumenti"
- Open Graph tags for social sharing

## Accessibility

- Sidebar: `<nav aria-label="Kategorije dokumenata">`
- Active category: `aria-current="page"`
- Download buttons: `aria-label="Preuzmi [title]"`
- Search input with proper label

## Files

| File | Action |
|------|--------|
| `packages/database/src/repositories/documents.ts` | Add getDistinctYears, getCategoryCounts |
| `packages/ui/src/components/document-card.tsx` | Create |
| `packages/ui/src/components/document-sidebar.tsx` | Create |
| `packages/ui/src/components/document-accordion.tsx` | Create |
| `packages/ui/src/components/year-filter.tsx` | Create |
| `packages/ui/src/index.ts` | Export new components |
| `apps/web/app/dokumenti/page.tsx` | Create |

## Out of Scope (YAGNI)

- Document preview modal
- Bulk download
- Document versioning display
- Sub-category grouping within list (defer to future sprint if needed)
